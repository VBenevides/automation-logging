

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>automation_logging.core &mdash; automation logging 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            automation logging
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">automation_logging</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">automation logging</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">automation_logging.core</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for automation_logging.core</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Core logging functionality for automation logging library.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">threading</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lock</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">getpass</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntEnum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_logging_level</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.screenshots</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScreenshotManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.global_logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_global_log</span>


<div class="viewcode-block" id="LogLevel">
<a class="viewcode-back" href="../../modules.html#automation_logging.LogLevel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">LogLevel</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">INFO</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">STAT</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">WARNING</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">EXCEPTION</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="mi">7</span>

<div class="viewcode-block" id="LogLevel.to_logging_level">
<a class="viewcode-back" href="../../modules.html#automation_logging.LogLevel.to_logging_level">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_logging_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the corresponding logging level from the logging module.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">STAT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">EXCEPTION</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>  <span class="c1"># logging.exception also uses logging.ERROR level</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown LogLevel: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="AutomationLogger">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AutomationLogger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class used to log the program execution to a file</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; log_dir = &quot;./tests/Logs&quot;</span>
<span class="sd">    &gt;&gt;&gt; log = AutomationLogger(script_path=__file__, log_dir=log_dir, log_to_console=True)</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; log.info(&quot;Start of program&quot;)</span>
<span class="sd">    &gt;&gt;&gt; for i in range(10):</span>
<span class="sd">    &gt;&gt;&gt;     log.info(f&quot;Iteration index: {i}&quot;)</span>
<span class="sd">    &gt;&gt;&gt; try:</span>
<span class="sd">    &gt;&gt;&gt;     error = 1 / 0</span>
<span class="sd">    &gt;&gt;&gt; except Exception as exc:</span>
<span class="sd">    &gt;&gt;&gt;     log.exception(f&quot;Exception caught: {repr(exc)}&quot;)</span>
<span class="sd">    &gt;&gt;&gt; log.info(&quot;End of program&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">script_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">log_to_console</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">log_to_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_logs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
        <span class="n">max_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
        <span class="n">as_logging_root</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">as_global_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">level_threshold</span><span class="p">:</span> <span class="n">LogLevel</span> <span class="o">=</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a AutomationLogger object for standardized logging in a script or robot.</span>

<span class="sd">        This class introduces a log level called &quot;STAT&quot; (short for statistics), designed</span>
<span class="sd">        for dumping dictionaries of information usable with logging solutions (e.g., ELK stack).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        script_path : str</span>
<span class="sd">            Absolute path of the script calling this function. Use __file__ or</span>
<span class="sd">            os.path.abspath(__file__) to retrieve the path.</span>

<span class="sd">        log_dir : str, optional</span>
<span class="sd">            Path to the directory where logs will be stored. If None, logs will be stored</span>
<span class="sd">            in the directory script_path/Logs.</span>

<span class="sd">        log_to_console : bool, optional</span>
<span class="sd">            If True, log messages will also appear on the console.</span>

<span class="sd">        log_to_file : bool, optional</span>
<span class="sd">            If True, creates a log file and writes to it</span>

<span class="sd">        max_logs : int, optional</span>
<span class="sd">            Number of log files to retain in the log directory.</span>

<span class="sd">        max_days : int, optional</span>
<span class="sd">            Number of days of log history to retain in the log folder.</span>

<span class="sd">        encoding : str, optional</span>
<span class="sd">            Encoding used by the logger object.</span>

<span class="sd">        as_logging_root: bool, optional</span>
<span class="sd">            Flag that controls if the root logger of the `logging` library will use the same configurations as AutomationLogger</span>
<span class="sd">            When set, code that uses `logging` functions (e.g info(), error()...) will follow the AutomationLogger configuration</span>

<span class="sd">            One reason to keep it as False is to avoid polluting the log with messages from packages that use `logging` internally</span>

<span class="sd">        as_global_log: bool, optional</span>
<span class="sd">            Flag that controls if this logger object will be set as the module&#39;s global logger.</span>
<span class="sd">            When set, it will be possible to use the module&#39;s logging functions without using set_global_log</span>

<span class="sd">        level_threshold: LogLevel</span>
<span class="sd">            Lowest log level that will be logged, Any level less severe than the current one will be ignored.</span>
<span class="sd">            The order from least severe to most severe: debug, info, state, warning, error, exception, critical</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `mode` passed is invalid</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `max_logs` is not a positive integer</span>
<span class="sd">        ValueError</span>
<span class="sd">            If `max_days` is not a positive integer</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import logging</span>
<span class="sd">        &gt;&gt;&gt; from automation_logging import AutomationLogger</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; log_dir = &quot;./tests/Logs&quot;</span>
<span class="sd">        &gt;&gt;&gt; logger = AutomationLogger(script_path=__file__, log_dir=log_dir, log_to_console=True, set_logging_root = True)</span>
<span class="sd">        &gt;&gt;&gt; logger.info(&quot;This INFO message was written using a AutomationLogger method&quot;)</span>
<span class="sd">        &gt;&gt;&gt; logging.info(&quot;This INFO message was written using a logging function and was written to the same file&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_logs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">max_logs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_logs parameter must be a positive integer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_days</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">max_days</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_days parameter must be a positive integer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level_threshold</span><span class="p">,</span> <span class="n">LogLevel</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;level_threshold must be a LogLevel&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_to_console</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">log_to_file</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;log_to_console and log_to_file cannot be both False&quot;</span><span class="p">)</span>

        <span class="n">log_dir</span> <span class="o">=</span> <span class="n">log_dir</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">script_path</span><span class="p">),</span> <span class="s2">&quot;Logs&quot;</span><span class="p">)</span>
        <span class="n">script_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">script_path</span><span class="p">)</span>
        <span class="n">script_name_no_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">script_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">log_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_name_no_ext</span><span class="si">}</span><span class="s2">.log&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">log_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">log_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span> <span class="n">LogLevel</span> <span class="o">=</span> <span class="n">level_threshold</span>
        <span class="c1"># Include private mutex to make this class thread-safe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutex</span><span class="p">:</span> <span class="n">Lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

        <span class="c1"># Initialize screenshot manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span><span class="p">:</span> <span class="n">ScreenshotManager</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Delete older files and create current directory</span>
            <span class="k">if</span> <span class="n">log_to_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clear_log_dir</span><span class="p">(</span>
                    <span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span>
                    <span class="n">max_logs</span><span class="o">=</span><span class="n">max_logs</span><span class="p">,</span>
                    <span class="n">max_days</span><span class="o">=</span><span class="n">max_days</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">log_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># Getting system and user information to include in the log</span>
            <span class="n">system_name</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>
            <span class="n">user_domain</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USERDOMAIN&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user_domain</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">complete_user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">complete_user</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user_domain</span><span class="si">}</span><span class="se">\\</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># Configuring the logger object</span>
            <span class="c1"># include -10s to levelname to make all messages start at the same column</span>
            <span class="n">_log_format</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;%(asctime)s | </span><span class="si">{</span><span class="n">system_name</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">complete_user</span><span class="si">}</span><span class="s2"> | %(name)s&quot;</span>
                <span class="s2">&quot; | </span><span class="si">%(levelname)-10s</span><span class="s2"> | </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="p">:</span> <span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">script_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level_threshold</span><span class="o">.</span><span class="n">to_logging_level</span><span class="p">())</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Reset handlers</span>

            <span class="c1"># Formatter</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">_log_format</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S%z&quot;</span><span class="p">)</span>

            <span class="c1"># log to file</span>
            <span class="k">if</span> <span class="n">log_to_file</span><span class="p">:</span>
                <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
                <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level_threshold</span><span class="o">.</span><span class="n">to_logging_level</span><span class="p">())</span>
                <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>

            <span class="c1"># print in console</span>
            <span class="k">if</span> <span class="n">log_to_console</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>

            <span class="c1"># Create new log level</span>
            <span class="n">add_logging_level</span><span class="p">(</span><span class="s2">&quot;STAT&quot;</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">STAT</span><span class="o">.</span><span class="n">to_logging_level</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">as_logging_root</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">handlers</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">as_global_log</span><span class="p">:</span>
                <span class="n">set_global_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="c1"># Initialize screenshot manager after log directory is set</span>
            <span class="k">if</span> <span class="n">log_to_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span> <span class="o">=</span> <span class="n">ScreenshotManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;AutomationLogger object instantiated&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when instantiating AutomationLogger object: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error_traceback</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">error_traceback</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Writing the error inside log_error.txt&quot;</span><span class="p">)</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;log_error.txt&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error when instantiating AutomationLogger object: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s2">&quot;----------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error_traceback</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">exc</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_clear_log_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_logs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">max_days</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes old logs and creates the directory for the current log.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        log_dir : str</span>
<span class="sd">            Path to the directory where logs will be stored. If None, logs will be stored</span>
<span class="sd">            in the directory specified during initialization.</span>

<span class="sd">        max_logs : int</span>
<span class="sd">            Number of log files to retain in the log directory.</span>

<span class="sd">        max_days : int</span>
<span class="sd">            Number of days of log history to retain in the log folder.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            String with the folder path for the current execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;exec_%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
        <span class="c1"># Delete older execution if limit of executions has been reached</span>
        <span class="c1"># Condition 1) Delete based on the number of log files</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">x</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">log_dir</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="ow">and</span> <span class="s2">&quot;exec_&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">num_delete</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">-</span> <span class="n">max_logs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_delete</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="c1"># In case of permission error when deleting files, instead of crashing the program,</span>
                <span class="c1"># the files won&#39;t be deleted (need to be manually deleted)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when deleting old log files: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Condition 2) Delete based on date in the file name and a cutoff date</span>
        <span class="n">cutoff_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">max_days</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">log_dir</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="ow">and</span> <span class="s2">&quot;exec_&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">file_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;exec_%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">file_date</span> <span class="o">&lt;=</span> <span class="n">cutoff_date</span><span class="p">:</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when deleting old log files: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>

        <span class="c1"># Create log dir for the current execution</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_dir</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="n">LogLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the message to the log file with the given level</span>
<span class="sd">        If the level is lower than the threshold, the message is not written</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutex</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">STAT</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportAttributeAccessIssue, reportUnknownMemberType]</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">EXCEPTION</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<div class="viewcode-block" id="AutomationLogger.debug">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.debug">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the message to the log file with level DEBUG</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; log.debug(f&quot;This is a DEBUG example&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.info">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the message to the log file with level INFO.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; log.info(f&quot;This is an INFO example&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.warning">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.warning">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the message to the log file with level WARNING.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; log.warning(&quot;This is a WARNING example&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.error">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.error">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the message to the log file with level ERROR.</span>

<span class="sd">        The difference between log.error and log.exception is that log.exception also prints</span>
<span class="sd">        the stack traceback of the exception.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; try:</span>
<span class="sd">        &gt;&gt;&gt;     a = 1/0</span>
<span class="sd">        &gt;&gt;&gt; except Exception as exc:</span>
<span class="sd">        &gt;&gt;&gt;     log.error(f&quot;This is an ERROR example: {repr(exc)}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.critical">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.critical">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the message to the log file with level CRITICAL.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; is_valid = check_critical_component(...)</span>
<span class="sd">        &gt;&gt;&gt; if not is_valid:</span>
<span class="sd">        &gt;&gt;&gt;     log.critical(&quot;This is a CRITICAL example, cannot continue&quot;)</span>
<span class="sd">        &gt;&gt;&gt;     sys.exit(2)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.exception">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.exception">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes an exception to the log file with level ERROR.</span>

<span class="sd">        The difference between log.error and log.exception is that log.exception also prints</span>
<span class="sd">        the stack traceback of the exception.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; try:</span>
<span class="sd">        &gt;&gt;&gt;     a = 1/0</span>
<span class="sd">        &gt;&gt;&gt; except Exception as exc:</span>
<span class="sd">        &gt;&gt;&gt;     log.exception(f&quot;This is an EXCEPTION example: {repr(exc)}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">EXCEPTION</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.stat">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.stat">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a dictionary to the log file with level STAT.</span>

<span class="sd">        This method should be used to aggregate or summarize information in a single message</span>
<span class="sd">        to facilitate the use of analytics solutions like elastic and opensearch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message: str | dict[Any, Any]</span>
<span class="sd">            Message to be logged</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; log = AutomationLogger(script_path=__file__)</span>
<span class="sd">        &gt;&gt;&gt; info_dict = {&quot;program_name&quot;: &quot;Test Program&quot;, &quot;var1&quot;: &quot;StringVariable&quot;, &quot;var2&quot;: 3}</span>
<span class="sd">        &gt;&gt;&gt; log.stat(info_dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">LogLevel</span><span class="o">.</span><span class="n">STAT</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.capture_screenshot">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.capture_screenshot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">capture_screenshot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">optimize_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Captures a screenshot of the entire screen and saves it in the log directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str, optional</span>
<span class="sd">            Name of the screenshot.</span>
<span class="sd">        optimize_size : bool</span>
<span class="sd">            Flag to save the image using a memory efficient and lossless format (.webp)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file saved</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If screenshot manager is not available (log_to_file=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Screenshot functionality requires log_to_file=True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span><span class="o">.</span><span class="n">capture_screenshot</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">optimize_size</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.capture_screenshot_selenium">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.capture_screenshot_selenium">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">capture_screenshot_selenium</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Captures a screenshot of a Selenium driver instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        driver : WebDriver</span>
<span class="sd">            Selenium WebDriver instance from which to capture the screenshot.</span>
<span class="sd">        filename : str, optional</span>
<span class="sd">            Name of the screenshot.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file saved</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If screenshot manager is not available (log_to_file=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Screenshot functionality requires log_to_file=True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span><span class="o">.</span><span class="n">capture_screenshot_selenium</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></div>


<div class="viewcode-block" id="AutomationLogger.group_by_prefix">
<a class="viewcode-back" href="../../modules.html#automation_logging.AutomationLogger.group_by_prefix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">group_by_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group files in the log directory by prefix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        prefix: str, optional</span>
<span class="sd">            Prefix of files that will be grouped</span>
<span class="sd">        sep: str, optional</span>
<span class="sd">            Separator used to split file names and automatically determine file prefixes.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If screenshot manager is not available (log_to_file=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;File grouping functionality requires log_to_file=True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot_manager</span><span class="o">.</span><span class="n">group_by_prefix</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Vinicius Benevides.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>